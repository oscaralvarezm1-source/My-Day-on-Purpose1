<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>My Day, On Purpose âœ¨</title>
  <style>
    :root{
      --bg:#0b1020;
      --card:#121a33;
      --card2:#0f1730;
      --text:#e9ecff;
      --muted:#b7c0ff;
      --accent:#a78bfa;
      --accent2:#22d3ee;
      --good:#34d399;
      --warn:#fbbf24;
      --bad:#fb7185;
      --border:rgba(255,255,255,.10);
      --shadow: 0 18px 40px rgba(0,0,0,.35);
      --radius:18px;
    }

    *{box-sizing:border-box}
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
      background: radial-gradient(1200px 700px at 30% 20%, rgba(167,139,250,.18), transparent 60%),
                  radial-gradient(900px 600px at 80% 40%, rgba(34,211,238,.14), transparent 55%),
                  var(--bg);
      color:var(--text);
      padding:20px;
    }

    .wrap{max-width:980px; margin:0 auto;}
    header{
      display:flex; gap:14px; align-items:center; justify-content:space-between;
      margin:6px 0 18px;
    }
    .title{
      display:flex; flex-direction:column; gap:3px;
    }
    h1{
      margin:0;
      font-size:22px;
      letter-spacing:.2px;
    }
    .subtitle{
      margin:0;
      color:var(--muted);
      font-size:13px;
    }

    .pill{
      display:inline-flex; gap:8px; align-items:center;
      padding:10px 12px;
      border:1px solid var(--border);
      border-radius:999px;
      background:rgba(255,255,255,.04);
      box-shadow: var(--shadow);
      font-size:13px;
      color:var(--muted);
      user-select:none;
    }

    .grid{
      display:grid;
      grid-template-columns: 1.05fr .95fr;
      gap:16px;
    }
    @media (max-width: 900px){
      .grid{grid-template-columns:1fr}
    }

    .card{
      background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.03));
      border:1px solid var(--border);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      overflow:hidden;
    }
    .card .hd{
      padding:14px 16px;
      display:flex; align-items:center; justify-content:space-between;
      background: rgba(255,255,255,.02);
      border-bottom:1px solid var(--border);
    }
    .card .hd b{font-size:14px}
    .card .bd{padding:14px 16px}

    .row{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:10px;
      margin-bottom:10px;
    }
    .row3{
      display:grid;
      grid-template-columns: 1fr 1fr 1fr;
      gap:10px;
      margin-bottom:10px;
    }
    @media (max-width: 560px){
      .row, .row3{grid-template-columns:1fr}
    }

    label{
      display:block;
      font-size:12px;
      color:var(--muted);
      margin-bottom:6px;
    }
    input, select{
      width:100%;
      padding:10px 10px;
      border-radius:12px;
      border:1px solid var(--border);
      background: rgba(8,12,26,.55);
      color: var(--text);
      outline:none;
    }
    input:focus, select:focus{border-color: rgba(167,139,250,.55); box-shadow: 0 0 0 3px rgba(167,139,250,.15);}
    .small{
      font-size:12px;
      color:var(--muted);
      margin-top:8px;
      line-height:1.4;
    }

    .kpis{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:10px;
      margin-top:10px;
    }
    .kpi{
      padding:12px;
      border-radius:16px;
      border:1px solid var(--border);
      background: rgba(255,255,255,.03);
    }
    .kpi .t{font-size:12px; color:var(--muted); margin-bottom:4px}
    .kpi .v{font-size:18px; font-weight:700}
    .kpi .s{font-size:12px; color:var(--muted); margin-top:4px}

    .timeline{
      display:flex;
      flex-direction:column;
      gap:10px;
    }
    .bar{
      border:1px solid var(--border);
      background: rgba(255,255,255,.03);
      border-radius: 16px;
      overflow:hidden;
    }
    .barTrack{
      display:flex;
      height:34px;
      width:100%;
      background: rgba(0,0,0,.18);
    }
    .seg{
      height:100%;
      display:flex;
      align-items:center;
      justify-content:center;
      font-size:12px;
      padding:0 8px;
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
      border-right:1px solid rgba(255,255,255,.08);
    }
    .seg:last-child{border-right:none}

    /* Segment colors (soft) */
    .sleep{background: rgba(167,139,250,.28)}
    .routine{background: rgba(34,211,238,.22)}
    .commute{background: rgba(251,191,36,.20)}
    .work{background: rgba(52,211,153,.18)}
    .evening{background: rgba(251,113,133,.18)}
    .free{background: rgba(255,255,255,.10)}

    .legend{
      display:flex; flex-wrap:wrap; gap:8px;
      margin-top:10px;
      color:var(--muted);
      font-size:12px;
    }
    .dot{
      width:10px; height:10px; border-radius:999px; display:inline-block; margin-right:6px;
      border:1px solid rgba(255,255,255,.10);
    }

    .noteBox{
      margin-top:12px;
      padding:12px;
      border-radius:16px;
      border:1px dashed rgba(255,255,255,.18);
      background: rgba(255,255,255,.02);
      color: var(--muted);
      font-size:12px;
      line-height:1.45;
    }

    .btnRow{
      display:flex; gap:10px; flex-wrap:wrap;
      margin-top:12px;
    }
    button{
      cursor:pointer;
      border:none;
      border-radius: 14px;
      padding:10px 12px;
      background: linear-gradient(135deg, rgba(167,139,250,.95), rgba(34,211,238,.80));
      color: #071022;
      font-weight:800;
      box-shadow: 0 12px 25px rgba(0,0,0,.28);
    }
    button.secondary{
      background: rgba(255,255,255,.06);
      color: var(--text);
      border:1px solid var(--border);
      box-shadow:none;
      font-weight:700;
    }
    footer{
      margin-top:14px;
      color:var(--muted);
      font-size:12px;
      text-align:center;
      opacity:.9;
    }
  </style>
</head>
<body>
<div class="wrap">
  <header>
    <div class="title">
      <h1>My Day, On Purpose âœ¨</h1>
      <p class="subtitle">A tiny timeline that shows where the day goes â€” plus bedtime + commute math.</p>
    </div>
    <div class="pill" id="todayPill">ðŸŒ™ Cute Planner Mode</div>
  </header>

  <div class="grid">
    <!-- Inputs -->
    <section class="card">
      <div class="hd">
        <b>Inputs</b>
        <span style="color:var(--muted); font-size:12px;">Option C) Timeline</span>
      </div>
      <div class="bd">
        <div class="row">
          <div>
            <label>Wake time</label>
            <input id="wake" type="time" value="04:40">
          </div>
          <div>
            <label>Sleep goal</label>
            <select id="sleepGoal">
              <option value="7">7 hours</option>
              <option value="7.5" selected>7.5 hours</option>
              <option value="8">8 hours</option>
            </select>
          </div>
        </div>

        <div class="row">
          <div>
            <label>Work start</label>
            <input id="workStart" type="time" value="06:00">
          </div>
          <div>
            <label>Work end</label>
            <input id="workEnd" type="time" value="15:00">
          </div>
        </div>

        <div class="row3">
          <div>
            <label>Morning routine (min)</label>
            <input id="morningRoutine" type="number" min="0" step="5" value="35">
          </div>
          <div>
            <label>Evening needs (min)</label>
            <input id="eveningNeeds" type="number" min="0" step="5" value="90">
          </div>
          <div>
            <label>Commute buffer (min)</label>
            <input id="buffer" type="number" min="0" step="5" value="10">
          </div>
        </div>

        <div class="row">
          <div>
            <label>Morning traffic</label>
            <select id="trafficAM">
              <option value="45">Light (45m)</option>
              <option value="60" selected>Regular (60m)</option>
              <option value="90">Heavy (90m)</option>
            </select>
          </div>
          <div>
            <label>Afternoon traffic</label>
            <select id="trafficPM">
              <option value="45">Light (45m)</option>
              <option value="60" selected>Regular (60m)</option>
              <option value="90">Heavy (90m)</option>
            </select>
          </div>
        </div>

        <div class="btnRow">
          <button id="copySummary">Copy todayâ€™s summary</button>
          <button class="secondary" id="resetDefaults">Reset defaults</button>
        </div>

        <div class="small">
          Tip: set <b>Evening needs</b> to include dinner/shower/chores. Free time = whatâ€™s left.
        </div>
      </div>
    </section>

    <!-- Outputs -->
    <section class="card">
      <div class="hd">
        <b>Results</b>
        <span style="color:var(--muted); font-size:12px;">(auto-calculated)</span>
      </div>
      <div class="bd">
        <div class="kpis">
          <div class="kpi">
            <div class="t">Ideal bedtime for sleep goal</div>
            <div class="v" id="idealBed">â€”</div>
            <div class="s" id="sleepNote">Wake at â€”</div>
          </div>
          <div class="kpi">
            <div class="t">Leave home (AM)</div>
            <div class="v" id="leaveHome">â€”</div>
            <div class="s" id="leaveNote">Work start â€”</div>
          </div>
          <div class="kpi">
            <div class="t">Arrive home (PM)</div>
            <div class="v" id="arriveHome">â€”</div>
            <div class="s" id="arriveNote">Work end â€”</div>
          </div>
          <div class="kpi">
            <div class="t">Free time (estimated)</div>
            <div class="v" id="freeTime">â€”</div>
            <div class="s" id="freeNote">After evening needs</div>
          </div>
        </div>

        <div style="height:10px"></div>

        <div class="timeline">
          <div style="display:flex;justify-content:space-between;align-items:center;">
            <b style="font-size:14px">Where did my day go?</b>
            <span style="font-size:12px;color:var(--muted)" id="daySpan">â€”</span>
          </div>

          <div class="bar">
            <div class="barTrack" id="barTrack"></div>
          </div>

          <div class="legend">
            <span><span class="dot sleep" style="background:rgba(167,139,250,.28)"></span>Sleep</span>
            <span><span class="dot routine" style="background:rgba(34,211,238,.22)"></span>Routine</span>
            <span><span class="dot commute" style="background:rgba(251,191,36,.20)"></span>Commute</span>
            <span><span class="dot work" style="background:rgba(52,211,153,.18)"></span>Work</span>
            <span><span class="dot evening" style="background:rgba(251,113,133,.18)"></span>Evening needs</span>
            <span><span class="dot free" style="background:rgba(255,255,255,.10)"></span>Free time</span>
          </div>

          <div class="noteBox" id="insightBox">â€”</div>
        </div>
      </div>
    </section>
  </div>

  <footer>
    Made with ðŸ’œ for a calmer day. (This runs locally â€” no accounts, no data saved.)
  </footer>
</div>

<script>
  // ---------- Time helpers ----------
  function parseTimeToMinutes(t){
    // "HH:MM" -> minutes from 0..1439
    if(!t || !t.includes(":")) return 0;
    const [h,m] = t.split(":").map(Number);
    return (h*60 + m) % 1440;
  }
  function minutesToTime(min){
    // minutes can be negative or > 1440; wrap
    let m = ((min % 1440) + 1440) % 1440;
    const h = Math.floor(m/60);
    const mm = m % 60;
    const hhStr = String(h).padStart(2,"0");
    const mmStr = String(mm).padStart(2,"0");
    // friendly 12h
    const ampm = h >= 12 ? "PM" : "AM";
    const h12 = (h % 12) === 0 ? 12 : (h % 12);
    return `${h12}:${mmStr} ${ampm}`;
  }
  function minutesToDuration(min){
    const m = Math.max(0, Math.round(min));
    const h = Math.floor(m/60);
    const r = m % 60;
    if(h === 0) return `${r}m`;
    if(r === 0) return `${h}h`;
    return `${h}h ${r}m`;
  }
  function clamp(n, a, b){ return Math.max(a, Math.min(b, n)); }

  // ---------- DOM ----------
  const el = (id)=>document.getElementById(id);

  const inputs = [
    "wake","sleepGoal","workStart","workEnd",
    "morningRoutine","eveningNeeds","buffer",
    "trafficAM","trafficPM"
  ].map(el);

  // ---------- Core calc ----------
  function compute(){
    const wake = parseTimeToMinutes(el("wake").value);
    const sleepGoalHours = Number(el("sleepGoal").value);
    const sleepGoalMin = sleepGoalHours * 60;

    const workStart = parseTimeToMinutes(el("workStart").value);
    const workEnd = parseTimeToMinutes(el("workEnd").value);

    const morningRoutine = Number(el("morningRoutine").value || 0);
    const eveningNeeds = Number(el("eveningNeeds").value || 0);
    const buffer = Number(el("buffer").value || 0);

    const trafficAM = Number(el("trafficAM").value);
    const trafficPM = Number(el("trafficPM").value);

    // Ideal bedtime based on wake time
    const idealBed = wake - sleepGoalMin;

    // Leave home time for workStart with traffic + buffer
    const leaveHome = workStart - trafficAM - buffer;

    // Arrive home time from workEnd + trafficPM
    const arriveHome = workEnd + trafficPM;

    // Build a "day visibility" window: from wake to ideal bedtime (same-day target)
    // If ideal bedtime is before wake (it is), we treat it as happening on the previous day.
    // For display, we want the day window from wake -> bedtime (bedtime is later in the day).
    // So we compute target bedtime in the evening of the SAME calendar day:
    // That is: bedtimeToday = idealBed + 1440 (wrap into later same day).
    const bedtimeToday = idealBed + 1440;

    // Now compute blocks within wake->bedtimeToday
    // We'll estimate: sleep is outside this window; show sleep as a segment for context anyway.
    // Timeline segments in the visible day:
    // Routine: morningRoutine
    // Commute AM: trafficAM
    // Work: duration between workStart and workEnd (handle wrap if needed)
    let workDur = workEnd - workStart;
    if(workDur < 0) workDur += 1440;

    // Evening needs: eveningNeeds
    // Free time: remaining in window after subtracting routine, commute, work, commute, eveningNeeds
    const dayWindow = bedtimeToday - wake; // should be around 16-18h
    const used = morningRoutine + trafficAM + workDur + trafficPM + eveningNeeds;
    const free = clamp(dayWindow - used, 0, 24*60);

    // Output KPI text
    el("idealBed").textContent = minutesToTime(idealBed);
    el("sleepNote").textContent = `Wake at ${minutesToTime(wake)} â€¢ Goal ${sleepGoalHours}h`;

    el("leaveHome").textContent = minutesToTime(leaveHome);
    el("leaveNote").textContent = `Traffic ${trafficAM}m + buffer ${buffer}m`;

    el("arriveHome").textContent = minutesToTime(arriveHome);
    el("arriveNote").textContent = `Traffic ${trafficPM}m`;

    el("freeTime").textContent = minutesToDuration(free);
    el("freeNote").textContent = `Day window: ${minutesToDuration(dayWindow)} total`;

    // Day span label
    el("daySpan").textContent =
      `${minutesToTime(wake)} â†’ ${minutesToTime(bedtimeToday)} (target)`;

    // Build timeline bar segments as percentages of dayWindow
    const track = el("barTrack");
    track.innerHTML = "";

    function addSeg(label, mins, cls){
      const pct = dayWindow > 0 ? (mins / dayWindow) * 100 : 0;
      const div = document.createElement("div");
      div.className = `seg ${cls}`;
      div.style.width = `${pct}%`;
      div.title = `${label}: ${minutesToDuration(mins)}`;
      div.textContent = pct >= 10 ? label : "";
      track.appendChild(div);
    }

    addSeg("Routine", morningRoutine, "routine");
    addSeg("Commute AM", trafficAM, "commute");
    addSeg("Work", workDur, "work");
    addSeg("Commute PM", trafficPM, "commute");
    addSeg("Evening", eveningNeeds, "evening");
    addSeg("Free", free, "free");

    // Insight box
    const sleepDebt = Math.max(0, (10*60 + 30) - bedtimeToday); // compares to 10:30 PM just as a "check"
    let insight = `If she wants ${sleepGoalHours}h and wakes at ${minutesToTime(wake)}, target bedtime is ${minutesToTime(idealBed)}.\n\n`;
    insight += `Estimated fixed time today: work ${minutesToDuration(workDur)} + commutes ${minutesToDuration(trafficAM + trafficPM)} + routine ${minutesToDuration(morningRoutine)} + evening needs ${minutesToDuration(eveningNeeds)} = ${minutesToDuration(used)}.\n`;
    insight += `That leaves about ${minutesToDuration(free)} of free time before the target bedtime.`;

    // Add a gentle nudge if free time is very low
    if(free < 60){
      insight += `\n\nðŸ«¶ Heads-up: free time is under 1 hour â€” the day will feel like it disappears.`;
    } else if(free < 120){
      insight += `\n\nâœ¨ Free time is tight â€” keeping a simple wind-down ritual can help the day feel less chaotic.`;
    } else {
      insight += `\n\nðŸŒ™ Nice: thereâ€™s some breathing room â€” protecting that â€œfree blockâ€ is the secret.`;
    }

    el("insightBox").textContent = insight;

    // Store last computed for copy
    window.__summary = {
      wake, sleepGoalHours, idealBed,
      workStart, workEnd, workDur,
      trafficAM, trafficPM, buffer,
      leaveHome, arriveHome,
      morningRoutine, eveningNeeds,
      dayWindow, free
    };
  }

  // ---------- Events ----------
  inputs.forEach(i => i.addEventListener("input", compute));
  inputs.forEach(i => i.addEventListener("change", compute));

  el("resetDefaults").addEventListener("click", ()=>{
    el("wake").value = "04:40";
    el("sleepGoal").value = "7.5";
    el("workStart").value = "06:00";
    el("workEnd").value = "15:00";
    el("morningRoutine").value = "35";
    el("eveningNeeds").value = "90";
    el("buffer").value = "10";
    el("trafficAM").value = "60";
    el("trafficPM").value = "60";
    compute();
  });

  el("copySummary").addEventListener("click", async ()=>{
    const s = window.__summary;
    if(!s) return;
    const text =
`My Day, On Purpose âœ¨
Wake: ${minutesToTime(s.wake)}
Sleep goal: ${s.sleepGoalHours}h â†’ Ideal bedtime: ${minutesToTime(s.idealBed)}

Work: ${minutesToTime(s.workStart)}â€“${minutesToTime(s.workEnd)} (${minutesToDuration(s.workDur)})
Commute AM: ${s.trafficAM}m + buffer ${s.buffer}m â†’ Leave: ${minutesToTime(s.leaveHome)}
Commute PM: ${s.trafficPM}m â†’ Arrive: ${minutesToTime(s.arriveHome)}

Routine: ${minutesToDuration(s.morningRoutine)}
Evening needs: ${minutesToDuration(s.eveningNeeds)}
Free time left (est.): ${minutesToDuration(s.free)}
`;
    try{
      await navigator.clipboard.writeText(text);
      el("todayPill").textContent = "âœ… Copied!";
      setTimeout(()=> el("todayPill").textContent = "ðŸŒ™ Cute Planner Mode", 1200);
    } catch(e){
      // fallback
      alert(text);
    }
  });

  // initial
  compute();
</script>
</body>
</html>